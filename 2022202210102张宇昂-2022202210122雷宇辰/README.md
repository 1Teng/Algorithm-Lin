## 问题假设
物流公司在流通过程中，需要将打包完毕的箱子装入到一个货车的车厢中，为了提高物流效率，需要尽可能提升车厢的装填率。

设车厢为长方体，其长宽高分别为 $L \times W \times H$；共有 $N$ 个箱子，箱子为长方体，第 $i$ 个箱子的长宽高为 $l_i \times w_i \times h_i$（ $N$ 个箱子的体积总和大于车厢的体积）。算法做出如下假设：

1. 箱子必须完全包含在车厢中；
1. 箱子下底面须与其它箱子接触；
1. 箱子可朝向各方向放置，共计6种摆放方式；
1. 箱子的各边与车厢各边平行放置；
1. 箱子不可互相重叠；
1. 箱子在装入时按照从里到外、从下到上的顺序进行。

算法的输入为车厢的长宽高数据与各箱子的长宽高数据，输出为箱子摆放在车厢中的坐标及车厢装填率。算法的目标为尽可能增大装填率。装填率计算方式如下：

$$ ratio=\frac{\sum_{i=1}^{n}{l_i \times w_i \times h_i}}{L \times W \times H}$$

算法实现在线与离线两个场景。在线场景即箱子装填顺序随机且不可改变，离线场景即箱子装填顺序可改变。

## 在线算法设计
在线场景下，算法采用拟人式策略[1]，即仿照人工装填车厢的方式，从里向外、从下向上装填，并设置 $x$ 轴和 $z$ 轴的装填参考线作为引导。

1. **可放置点选择**。根据人工装填的经验，新的箱子需靠在已装填的箱子上码放成堆，以提高空间利用率。因此，当一个箱子装入后，将其与其它箱子或车厢重合的顶点加入可放置点列表中。具体而言，若第 $i$ 个箱子放置在 $(x,y,z)$，则在可放置点列表中删除 $(x,y,z)$，并增加 $(x+l_i,y,z)$ $(x,y+w_i,z)$ 和 $(x,y,z+h_i)$。箱子在放置时优先判断是否能够以可放置点作为放置的位置。初始时设置 $(0,0,0)$ 为可放置点。
1. **参考线**。分别在 $x$ 轴和 $z$ 轴设置两条参考线，当判断箱子能否装入时，要求其不超过参考线范围。若参考线范围内无法放入箱子，则提高 $x$ 轴参考线，若箱子成功装入，则依据该箱子的相应坐标设置新的参考线。若无法装入，则考虑提高 $z$ 轴参考线。若均无法装入，则认为该箱子无法装入车厢中。设置参考线的目的是优先利用将新箱子放置在已装入箱子周围，填充已装入箱子所形成的不规则空间。
1. **判断能否装入**。在判断箱子是否与已装入箱子重叠时，将箱子转化为二维判断。计算箱子的三个投影面，并要求三个长方形投影面在其平面上均不能与其它箱子的投影面相交。新箱子需与所有已装入箱子均无重叠。此外，箱子共有6种摆放方向，若6种摆放方向均无法满足要求，则认为该箱子无法装入。
1. **平移箱子**。在根据可放置点与参考线初步判定箱子的摆放位置后，在箱子不与其它箱子重叠的情况下，将箱子依次沿 $x$、 $y$、 $z$ 轴向坐标小的方向移动。
 
参考资料：[1] 张德富,魏丽军,陈青山,陈火旺.三维装箱问题的组合启发式算法[J].软件学报,2007(09):2083-2089.

## 离线算法设计
离线场景不要求箱子的到达顺序，因此可对箱子的装入顺序进行优化。
1. **贪心策略**。根据经验，优先装入体积较大的箱子可更有效地利用车厢空间。因此，将箱子序列按体积从大到小排列，作为装入顺序，使用在线算法进行装入。
1. **模拟退火**。将贪心策略得到的解作为初始解，以提高装填率为目标，采用模拟退火算法进行优化。产生新解的策略为：随机选择装填序列中的两个箱子，将选出的两个箱子之间的箱子装填顺序反转。
